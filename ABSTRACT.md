The authors of the **Cows2021 Dataset** feature identity annotations of the Holstein-Friesian cattle on a large scale. Additionally, they present a pioneering self-supervision framework tailored for the video-based identification of individual animals. Cows2021 encompasses an extensive collection of 10,402 RGB images, each meticulously labeled with both localization and identity information. Furthermore, the dataset incorporates 301 videos obtained from the same cattle herd. These videos provide top-down in-barn imagery, adept at capturing the distinctive black and white coat patterns characteristic of this breed. <i>Note, that the present version of the dataset at datasetninja has only images.</i>

Given the substantial labeling effort typically required for the development of visual cattle identification systems, the authors propose a novel approach. They leverage the temporal consistency in coat pattern appearance across videos as a self-supervision signal for learning animal identities. To facilitate this, they employ an individual-agnostic cattle detector that produces oriented bounding boxes. These boxes are then used to form rotation-normalized tracklets for individual cattle through a tracking-by-detection process, further enhanced by augmentations. This process generates a "positive" sample set for each tracklet, which is subsequently paired with a "negative" set randomly sampled from other videos featuring different cattle. The authors then employ frame-triplet contrastive learning to construct a metric latent space for identity learning.

<img src="https://github.com/supervisely/dataset-tools/assets/78355358/eccf9442-2c43-4541-ad8a-67dc4589c134" alt="image" width="600">

The Cows2021 features 186 Holstein-Friesian cattle and was captured using an Intel D435 camera at the University of Bristol's Wyndhurst Farm in Langford Village, UK. The camera was positioned 4 meters above the ground, overlooking a walkway connecting the milking parlour and holding pens. Recordings, triggered by motion, spanned a month after milking sessions.

The dataset provides images with a resolution of 1280 x 720 pixels per frame, utilizing 8 bits per RGB channel. It encompasses a total of 10,402 still images and 301 videos, each with a duration of 5.5 seconds and a frame rate of 30 frames per second. The distribution of still images across individuals and time aligns with the natural operation of the farm. Additionally, the dataset includes various expert-generated ground truth annotations.

For cattle torso annotations, adhering to VOC 2012 guidelines for object annotation, all visible *cattle torso* instances were manually labeled, excluding the head, neck, legs, and tail. Torso instances with significant clipping were tagged as "clipped" and excluded from further analysis.

Regarding animal identity annotations, a total of 13,784 detected cattle instances were manually assigned to one of 182 individuals, with four all-black cows excluded from the identity study for future research. The number of occurrences for each individual ***cow_id*** varies, with a mean (µ) of 77.5 and a standard deviation (σ) of 39.9.

The dataset also includes video data with tracklet annotations. These tracklets, vital for self-supervision in identity learning, were generated by utilizing a highly reliable ID-agnostic cattle detector and employing tracking-by-detection techniques. The average number of tracklets per video is 1.45.
